<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" href="/img/logo/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Nhà sách trực tuyến TikiTaka- TikiTaka.com</title>
    <script src="/js/checkPayment.js"></script>
</head>

<body>
    <header class="header">
        <nav class="container navbar">
            <div class="logo-container">
                <a href="/"><img src="/img/logo/logo.png" alt="" class="logo"></a>
            </div>
            <div class="box-search">
                <input type="text" placeholder="Tìm kiếm">
                <span><i class="fa-solid fa-magnifying-glass"></i></span>
            </div>
            <div class="user-cart-container">
                <div class="cart-item">
                    <a href="/giohang" style="color: #7A7E7F">
                        <div>
                            <i class="fa-solid fa-cart-shopping"></i>
                        </div>
                        <div>
                            <a href="/giohang" style="color: #7A7E7F;">Giỏ hàng</a>
                        </div>
                    </a>
                </div>
                <div class="user-item">
                    <!-- <div class="account" id="accountSection" th:style="${accountSection ? 'display: none;' : ''}">
                            <div>
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div>
                                <span>Tài khoản</span>
                            </div>
                            <div class="account-options">
                                <a href="/taikhoan/thongtin"><button id="btnAccountInfo" class="btn">Thông tin tài
                                        khoản</button></a>
                                <a href="/dangxuat"><button id="btnLogout" class="btn">Đăng xuất</button></a>
                            </div>
                        </div> -->
                    <!-- <div class="admin" id="adminSection" th:style="${adminSection ? 'display: none;' : ''}">
                            <div>
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div>
                                <span>Quản trị</span>
                            </div>
                            <div class="admin-options">
                                <a href="/quantri"><button id="btnAdminManage" class="btn">Quản lý</button></a>
                                <a href="/dangxuat"><button id="btnLogoutAdmin" class="btn">Đăng xuất</button></a>
                            </div>
                        </div> -->
                    <div class="user-options" id="userOptionsSection"
                        th:style="${userOptionsSection ? 'display: none;' : ''}">
                        <div class="login-register">
                            <a href="/dangnhap" class="btn-director-login">Đăng nhập</a>
                            <a href="/dangky" class="btn-director-register">Đăng ký</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <div class="container checkout-container">
        <div class="checkout-left clear-fix">
            <div class="checkout-product-container">
                <h2>Thông tin sản phẩm</h2>
                <div class="check-product-content">
                    <div class="checkout-product" id="checkout-product"></div>
                    <div class="checkout-order-container">
                        <div class="checkout-order-summary">
                            <div class="checkout-summary-label">Tạm tính: </div>
                            <div class="checkout-summary-value" id="divThanhTien"></div>
                        </div>
                        <div class="checkout-order-summary">
                            <div class="checkout-summary-label">Phí vận chuyển: </div>
                            <div class="checkout-summary-value">25,000đ</div>
                        </div>
                        <div class="checkout-order-summary">
                            <div class="checkout-summary-label">Tổng cộng: </div>
                            <div class="checkout-summary-value" id="divTotal"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="checkout-right">
            <h2>THÔNG TIN THANH TOÁN</h2>
            <div class="checkout-content">
                <form class="checkout-form" id="checkout-form" method="post">
                    <div class="form-group">
                        <label for="name">Họ và tên người nhận</label>
                        <input type="text" id="name" name="name" class="checkout-input" th:value="${account.userName}"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" class="checkout-input"
                            th:value="${account.userEmail}">
                    </div>
                    <div class="form-group">
                        <label for="phone">Số điện thoại</label>
                        <input type="tel" id="phone" name="phone" class="checkout-input" th:value="${account.userPhone}"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="address">Địa chỉ</label>
                        <input type="text" id="address" name="address" class="checkout-input"
                            th:value="${account.userAddress}" required>
                    </div>
                    <button type="submit" class="checkout-btn" onclick="postData(event)">Đặt hàng</button>
                </form>
                <div class="payment-method-box">
                    <h2>PHƯƠNG THỨC THANH TOÁN</h2>
                    <label>
                        <input type="radio" name="payment-method" value="cod" checked>
                        <img src="/img/cash.svg" alt="">Thanh toán khi nhận hàng (COD)
                    </label>
                    <label>
                        <input type="radio" name="payment-method" value="momo" checked>
                        <img src="/img/momo.svg" alt=""> Momo
                    </label>
                </div>
            </div>
        </div>
    </div>

    <footer style="display: flex;">
        <div class="footer-left">
            <div>
                <a href="/"><img src="/img/logo/logo.png" alt="" class="footer-logo"></a>
            </div>
            <div>
                <p>371, Nguyễn Kiệm Gò Vấp TP HCM.</p>
                <p>Công Ty Cổ Phần Phát Hành Sách TP HCM - TIKITAKA.</p>
                <p>187 Hoàng Văn Thụ, Phường 8, Phú Nhuận, TP. HCM, Việt Nam.</p>
            </div>
            <div>
                <p>
                    TIKITAKA.com nhận đặt hàng trực tuyến và giao hàng tận nơi. KHÔNG hỗ trợ đặt mua và nhận hàng trực
                    tiếp tại văn phòng cũng như tất cả Hệ Thống TIKITAKA trên toàn quốc.
                </p>
            </div>
            <div>
                <a href=""><img src="/img/logo-bo-cong-thuong-da-thong-bao1.png" alt=""
                        style="width: 150px; margin: 10px 0"></a>
            </div>
            <div class="social-group">
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-facebook" style="color: #3b5998;"></i></a>
                </div>
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-square-instagram" style="color: #dd2a7b"></i></a>
                </div>
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-youtube" style="color: #ff0000"></i></a>
                </div>
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-tumblr" style="color: #36356d"></i></a>
                </div>
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-twitter" style="color: #08a0e9"></i></a>
                </div>
                <div class="social-item">
                    <a href=""><i class="fa-brands fa-pinterest" style="color: #bd081c"></i></a>
                </div>
            </div>
            <div class="download-app">
                <a>
                    <img src="/img/android1.png" alt="">
                </a>
                <a href="">
                    <img src="/img/appstore1.png" alt="">
                </a>
            </div>
        </div>
        <div class="footer-right">
            <div class="footer-info">
                <div class="footer-info-container">
                    <div class="footer-info-item">
                        <h2>DỊCH VỤ</h2>
                        <ul>
                            <li><a href="/">Điều khoản sử dụng</a></li>
                            <li><a href="/">Chính sách bảo mật thông tin cá nhân</a></li>
                            <li><a href="/">Chính sách bảo mật thanh toán</a></li>
                            <li><a href="/">Giới thiệu Fahasa</a></li>
                            <li><a href="/">Hệ thống trung tâm - nhà sách</a></li>
                        </ul>
                    </div>
                    <div class="footer-info-item">
                        <h2>HỖ TRỢ</h2>
                        <ul>
                            <li><a href="/">Chính sách đổi - trả - hoàn tiền</a></li>
                            <li><a href="/">Chính sách bảo hành - bồi hoàn</a></li>
                            <li><a href="/">Chính sách vận chuyển</a></li>
                            <li><a href="/">Chính sách khách sỉ</a></li>
                            <li><a href="/">Phương thức thanh toán và xuất HĐ</a></li>
                        </ul>
                    </div>
                    <div class="footer-info-item">
                        <h2>TÀI KHOẢN CỦA TÔI</h2>
                        <ul>
                            <li><a href="/dangnhap">Đăng nhập/Tạo mới tài khoản</a></li>
                            <li><a href="/taikhoan/thongtin">Thay đổi địa chỉ khách hàng</a></li>
                            <li><a href="/taikhoan/thongtin">Chi tiết tài khoản</a></li>
                            <li><a href="/taikhoan/donhang">Lịch sử mua hàng</a></li>
                        </ul>
                    </div>
                    <div class="footer-info-item">
                        <h2>LIÊN HỆ</h2>
                        <ul>
                            <li><a href="/"><i class="fa-solid fa-location-dot"></i> 371 Nguyễn Kiệm, P.3, Q.Gò Vấp,
                                    TP.HCM</a></li>
                            <li><a href="/"><i class="fa-solid fa-envelope"></i> cskh@nhom1.com.vn</a></li>
                            <li><a href="/"><i class="fa-solid fa-phone"></i> 19003636</a></li>
                        </ul>
                    </div>
                    <div class="footer-info-item">
                        <ul>
                            <li><img src="/img/logo-momo.png" style="width: 150px; cursor: pointer;" alt=""></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</body>
<script>
    function postData(event) {
        event.preventDefault();
        console.log("Button clicked");
        var productItems = document.querySelectorAll('.checkout-product-item');
        var quantityElements = document.querySelectorAll('.checkout-product-item-qty span');
        var priceTransient = document.getElementById('divThanhTien').innerText;
        var email = document.getElementById("email").value;
        var phone = document.getElementById("phone").value;
        var address = document.getElementById("address").value;
        var paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;


        var bookList = [];
        var priceList = [];
        productItems.forEach(function (item) {
            var bookID = item.id
            bookList.push(bookID);
            var quantity = item.querySelector('.checkout-product-item-qty span').innerText;
            priceList.push(quantity)
        });

        var data = {
            "bookList": bookList,
            "priceList": priceList,
            "price": priceTransient,
            "phone": phone,
            "address": address,
            "paymentMethod": paymentMethod
        };

        localStorage.removeItem("cart")

        fetch('/giohang/thanhtoan', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error('Error:', error);
                console.log('Data sent to server:', data);
            });
        window.location.href = "/taikhoan";
    }
</script>

</html>